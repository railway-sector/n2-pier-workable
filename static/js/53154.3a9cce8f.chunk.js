"use strict";(self.webpackChunkn2_pier_workable=self.webpackChunkn2_pier_workable||[]).push([[1509,53154,58067],{10294:(e,t,r)=>{r.d(t,{S:()=>a});var s=r(15941),n=r(31633),i=r(20664),o=r(13927);function a(e,t,r){const a=function(e,t,r,s){const a=(e=>!Array.isArray(e[0]))(t)?(e,r)=>t[3*e+r]:(e,r)=>t[e][r],c=s?(0,n.GA)(s)/(0,n.G9)(s):1;return(0,o.lU)(e,(e,t)=>(0,i.j)(e,a(t,0)*c,a(t,1)*c,a(t,2)),r)}(c,e,t,r)?(0,o.Qj)(c):[0,0,1];return Math.abs(a[2])>Math.cos((0,s.kU)(80))?2:Math.abs(a[1])>Math.abs(a[0])?1:0}const c=(0,o.vt)()},38983:(e,t,r)=>{function s(e,t,r){r=r||2;var s,i,a,c,l,u,d,f=t&&t.length,p=f?t[0]*r:e.length,m=n(e,0,p,r,!0),_=[];if(!m||m.next===m.prev)return _;if(f&&(m=h(e,t,m,r)),e.length>80*r){s=a=e[0],i=c=e[1];for(var y=r;y<p;y+=r)(l=e[y])<s&&(s=l),(u=e[y+1])<i&&(i=u),l>a&&(a=l),u>c&&(c=u);d=0!==(d=Math.max(a-s,c-i))?1/d:0}return o(m,_,r,s,i,d),_}function n(e,t,r,s,n){var i,o;if(n===D(e,t,r,s)>0)for(i=t;i<r;i+=s)o=O(i,e[i],e[i+1],o);else for(i=r-s;i>=t;i-=s)o=O(i,e[i],e[i+1],o);if(o&&R(o,o.next)){var a=o.next;P(o),o=a}return o}function i(e,t){if(!e)return e;t||(t=e);var r,s=e;do{if(r=!1,s.steiner||!R(s,s.next)&&0!==w(s.prev,s,s.next))s=s.next;else{var n=s.prev;if(P(s),(s=t=n)===s.next)break;r=!0}}while(r||s!==t);return t}function o(e,t,r,s,n,h,d){if(e){!d&&h&&_(e,s,n,h);for(var f,p,m=e;e.prev!==e.next;)if(f=e.prev,p=e.next,h?c(e,s,n,h):a(e))t.push(f.i/r),t.push(e.i/r),t.push(p.i/r),P(e),e=p.next,m=p.next;else if((e=p)===m){d?1===d?o(e=l(i(e),t,r),t,r,s,n,h,2):2===d&&u(e,t,r,s,n,h):o(i(e),t,r,s,n,h,1);break}}}function a(e){var t=e.prev,r=e,s=e.next;if(w(t,r,s)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(v(t.x,t.y,r.x,r.y,s.x,s.y,n.x,n.y)&&w(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function c(e,t,r,s){var n=e.prev,i=e,o=e.next;if(w(n,i,o)>=0)return!1;for(var a=n.x<i.x?n.x<o.x?n.x:o.x:i.x<o.x?i.x:o.x,c=n.y<i.y?n.y<o.y?n.y:o.y:i.y<o.y?i.y:o.y,l=n.x>i.x?n.x>o.x?n.x:o.x:i.x>o.x?i.x:o.x,u=n.y>i.y?n.y>o.y?n.y:o.y:i.y>o.y?i.y:o.y,h=y(a,c,t,r,s),d=y(l,u,t,r,s),f=e.prevZ,p=e.nextZ;f&&f.z>=h&&p&&p.z<=d;){if(f!==e.prev&&f!==e.next&&v(n.x,n.y,i.x,i.y,o.x,o.y,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&v(n.x,n.y,i.x,i.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&v(n.x,n.y,i.x,i.y,o.x,o.y,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&v(n.x,n.y,i.x,i.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function l(e,t,r){var s=e;do{var n=s.prev,o=s.next.next;!R(n,o)&&b(n,s,s.next,o)&&M(n,o)&&M(o,n)&&(t.push(n.i/r),t.push(s.i/r),t.push(o.i/r),P(s),P(s.next),s=e=o),s=s.next}while(s!==e);return i(s)}function u(e,t,r,s,n,a){var c=e;do{for(var l=c.next.next;l!==c.prev;){if(c.i!==l.i&&x(c,l)){var u=G(c,l);return c=i(c,c.next),u=i(u,u.next),o(c,t,r,s,n,a),void o(u,t,r,s,n,a)}l=l.next}c=c.next}while(c!==e)}function h(e,t,r,s){var o,a,c,l=[];for(o=0,a=t.length;o<a;o++)(c=n(e,t[o]*s,o<a-1?t[o+1]*s:e.length,s,!1))===c.next&&(c.steiner=!0),l.push(g(c));for(l.sort(d),o=0;o<l.length;o++)r=i(r=p(l[o],r),r.next);return r}function d(e,t){return e.x-t.x}function f(e){if(e.next.prev===e)return e;let t=e;for(;;){const r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function p(e,t){var r=function(e,t){var r,s=t,n=e.x,i=e.y,o=-1/0;do{if(i<=s.y&&i>=s.next.y&&s.next.y!==s.y){var a=s.x+(i-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=n&&a>o){if(o=a,a===n){if(i===s.y)return s;if(i===s.next.y)return s.next}r=s.x<s.next.x?s:s.next}}s=s.next}while(s!==t);if(!r)return null;if(n===o)return r;var c,l=r,u=r.x,h=r.y,d=1/0;s=r;do{n>=s.x&&s.x>=u&&n!==s.x&&v(i<h?n:o,i,u,h,i<h?o:n,i,s.x,s.y)&&(c=Math.abs(i-s.y)/(n-s.x),M(s,e)&&(c<d||c===d&&(s.x>r.x||s.x===r.x&&m(r,s)))&&(r=s,d=c)),s=s.next}while(s!==l);return r}(e,t);if(!r)return t;var s=G(r,e),n=i(r,r.next);let o=f(s);return i(o,o.next),n=f(n),f(t===r?n:t)}function m(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function _(e,t,r,s){var n=e;do{null===n.z&&(n.z=y(n.x,n.y,t,r,s)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,s,n,i,o,a,c,l=1;do{for(r=e,e=null,i=null,o=0;r;){for(o++,s=r,a=0,t=0;t<l&&(a++,s=s.nextZ);t++);for(c=l;a>0||c>0&&s;)0!==a&&(0===c||!s||r.z<=s.z)?(n=r,r=r.nextZ,a--):(n=s,s=s.nextZ,c--),i?i.nextZ=n:e=n,n.prevZ=i,i=n;r=s}i.nextZ=null,l*=2}while(o>1)}(n)}function y(e,t,r,s,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function g(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function v(e,t,r,s,n,i,o,a){return(n-o)*(t-a)-(e-o)*(i-a)>=0&&(e-o)*(s-a)-(r-o)*(t-a)>=0&&(r-o)*(i-a)-(n-o)*(s-a)>=0}function x(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&b(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(M(e,t)&&M(t,e)&&function(e,t){var r=e,s=!1,n=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&n<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(s=!s),r=r.next}while(r!==e);return s}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||R(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function R(e,t){return e.x===t.x&&e.y===t.y}function b(e,t,r,s){var n=C(w(e,t,r)),i=C(w(e,t,s)),o=C(w(r,s,e)),a=C(w(r,s,t));return n!==i&&o!==a||!(0!==n||!A(e,r,t))||!(0!==i||!A(e,s,t))||!(0!==o||!A(r,e,s))||!(0!==a||!A(r,t,s))}function A(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function C(e){return e>0?1:e<0?-1:0}function M(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function G(e,t){var r=new E(e.i,e.x,e.y),s=new E(t.i,t.x,t.y),n=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,s.next=r,r.prev=s,i.next=s,s.prev=i,s}function O(e,t,r,s){var n=new E(e,t,r);return s?(n.next=s.next,n.prev=s,s.next.prev=n,s.next=n):(n.prev=n,n.next=n),n}function P(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(e,t,r,s){for(var n=0,i=t,o=r-s;i<r;i+=s)n+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return n}r.d(t,{e:()=>s}),s.deviation=function(e,t,r,s){var n=t&&t.length,i=n?t[0]*r:e.length,o=Math.abs(D(e,0,i,r));if(n)for(var a=0,c=t.length;a<c;a++){var l=t[a]*r,u=a<c-1?t[a+1]*r:e.length;o-=Math.abs(D(e,l,u,r))}var h=0;for(a=0;a<s.length;a+=3){var d=s[a]*r,f=s[a+1]*r,p=s[a+2]*r;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},s.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},s=0,n=0;n<e.length;n++){for(var i=0;i<e[n].length;i++)for(var o=0;o<t;o++)r.vertices.push(e[n][i][o]);n>0&&(s+=e[n-1].length,r.holes.push(s))}return r}},40366:(e,t,r)=>{r.d(t,{F:()=>h,a:()=>p,b:()=>d});var s=r(34761),n=r(13191),i=r(9392),o=r(86955),a=r(23687),c=r(12216),l=r(31432),u=r(2687);class h extends l.Y{constructor(){super(...arguments),this.origin=i.uY}}function d(){const e=new u.N5;return e.attributes.add("position","vec3"),e.outputs.add("fragColor","vec4",0),e.vertex.uniforms.add(new a.F("proj",e=>e.camera.projectionMatrix),new c.S("view",(e,t)=>(0,s.Tl)(f,t.camera.viewMatrix,e.origin))).main.add(o.H`gl_Position = proj * view * vec4(position, 1.0);
gl_Position.z = min(gl_Position.z, gl_Position.w);`),e.fragment.main.add(o.H`fragColor = vec4(1., 0., 0., 0.);`),e}const f=(0,n.vt)(),p=Object.freeze(Object.defineProperty({__proto__:null,FocusAreaMaskDrawParameters:h,build:d},Symbol.toStringTag,{value:"Module"}))},50360:(e,t,r)=>{r.d(t,{Pg:()=>c,fz:()=>l,g7:()=>o,zo:()=>a});var s=r(68707),n=(r(97799),r(63331),r(56175));r(91523);const i=new n.D;function o(e,t,r){return i.execute(e,t,r,null)}function a(e,t,r){const n=i.executeMany(new s.S(e),t,r,null);return Array.from(n)}function c(e,t,r){return i.isSimpleAsFeature(e,t,r,null,null)}function l(){return i.supportsCurves()}},58067:(e,t,r)=>{r.r(t),r.d(t,{fromExtent:()=>v,fromGeometry:()=>g,fromMultipoint:()=>x,fromPoint:()=>w,fromPolygon:()=>R,fromPolyline:()=>b,fromSpatialReference:()=>A,getSpatialReference:()=>y,toExtent:()=>M,toGeometry:()=>C,toMultipoint:()=>G,toPoint:()=>O,toPolygon:()=>P,toPolyline:()=>E});var s=r(26871),n=(r(21557),r(97799)),i=r(91523),o=r(63331),a=r(56175),c=r(76797),l=r(66388),u=r(19247),h=r(65215),d=r(23701),f=(r(59739),r(48045));const p="_gxVersion",m=2,_=1;function y(e){return Array.isArray(e)?e[0].spatialReference:e.spatialReference}function g(e){switch(e.type){case"point":return w(e);case"multipoint":return x(e);case"polyline":return b(e);case"polygon":return R(e);case"extent":return v(e);default:throw new Error(`Unsupported geometry type: ${e.type}`)}}function v(e){if(!e.getCacheValue(p)){const t=new i.E;t.setCoords(e.xmin,e.ymin,e.xmax,e.ymax),e.hasM&&t.setInterval(m,0,e.mmin,e.mmax),e.hasZ&&t.setInterval(_,0,e.zmin,e.zmax),e.setCacheValue(p,t)}return e.getCacheValue(p)}function x(e){if(!e.getCacheValue(p)){const t=new o.M,r=new i.P,s=e.points,n=e.hasM,a=e.hasZ,c=a?3:2;for(let e=0,i=s.length;e<i;e++){const i=s[e];r.setXYCoords(i[0],i[1]),a&&r.setZ(i[2]??0),n&&r.setM(i[c]??NaN),t.add(r)}e.setCacheValue(p,t)}return e.getCacheValue(p)}function w(e){if(!e.getCacheValue(p)){const t=new i.P;t.setXYCoords(e.x,e.y),e.hasM&&t.setM(e.m),e.hasZ&&t.setZ(e.z),e.setCacheValue(p,t)}return e.getCacheValue(p)}function R(e){if(!e.getCacheValue(p)){const{curveRings:t,hasM:r,hasZ:s,rings:n}=e,i=(0,f.fromGeometryToGXGeometry)({curveRings:t,hasM:r,hasZ:s,rings:n});e.setCacheValue(p,i)}return e.getCacheValue(p)}function b(e){if(!e.getCacheValue(p)){const{curvePaths:t,hasM:r,hasZ:s,paths:n}=e,i=(0,f.fromGeometryToGXGeometry)({curvePaths:t,hasM:r,hasZ:s,paths:n});e.setCacheValue(p,i)}return e.getCacheValue(p)}function A(e){if(e.wkid)return(0,a.c)(e.wkid);const t=e.wkt2||e.wkt;return t?(0,a.b)(t):null}function C(e,t){if(e)switch(e.getGeometryType()){case n.G.enumPoint:return O(e,t);case n.G.enumEnvelope:return M(e,t);case n.G.enumMultiPoint:return G(e,t);case n.G.enumPolyline:return E(e,t);case n.G.enumPolygon:return P(e,t)}return null}function M(e,t){if(e.isEmpty())return null;const r=new c.A({xmin:e.getXMin(),ymin:e.getYMin(),xmax:e.getXMax(),ymax:e.getYMax(),spatialReference:t}),s=e.getDescription();if(s.hasM()){const t=e.queryInterval(m,0);r.mmin=t.vmin,r.mmax=t.vmax}if(s.hasZ()){const t=e.queryInterval(_,0);r.zmin=t.vmin,r.zmax=t.vmax}return r.setCacheValue(p,e),r}function G(e,t){if(e.isEmpty())return null;const r=e.getDescription(),s=r.hasM(),n=r.hasZ(),o=[],a=new i.P;for(let i=0,l=e.getPointCount();i<l;i++){e.getPointByVal(i,a);const t=[a.getX(),a.getY()];n&&t.push(a.getZ()),s&&t.push(a.getM()),o.push(t)}const c=new l.A({hasM:s,hasZ:n,points:o,spatialReference:t});return c.setCacheValue(p,e),c}function O(e,t){if(e instanceof s.P)return new u.A({x:e.x,y:e.y,spatialReference:t});if(e.isEmpty())return null;const r=new u.A({x:e.getX(),y:e.getY(),spatialReference:t}),n=e.getDescription();return n.hasM()&&(r.m=e.getM()),n.hasZ()&&(r.z=e.getZ()),r.setCacheValue(p,e),r}function P(e,t){if(e.isEmpty())return null;const r=h.A.fromJSON({spatialReference:t,...(0,f.toGeometry)(e,null)});return r.setCacheValue(p,e),r}function E(e,t){if(e.isEmpty())return null;const r=d.A.fromJSON({spatialReference:t,...(0,f.toGeometry)(e,null)});return r.setCacheValue(p,e),r}},68707:(e,t,r)=>{r.d(t,{G:()=>s,S:()=>n});class s{*[Symbol.iterator](){let e=this.next();for(;e;)yield e,e=this.next()}}class n extends s{constructor(e){super(),this.m_iGeom=-1,this.m_aGeoms=e?e.slice():[]}next(){if(this.m_iGeom<this.m_aGeoms.length-1){const e=this.m_aGeoms[++this.m_iGeom];return this.m_aGeoms[this.m_iGeom]=null,e}return null}tock(){return!1}getGeometryID(){return this.m_iGeom}getRank(){return 1}}},73074:(e,t,r)=>{r.d(t,{P:()=>w});var s=r(54099),n=r(20664),i=r(9392),o=r(43047),a=r(55855),c=r(45308),l=r(42294),u=r(44815),h=r(18117),d=r(12482),f=r(731),p=r(85746),m=r(1307),_=r(49296),y=r(70667),g=r(29889),v=r(442),x=r(52479);class w extends p.X{constructor(e){super(e),this._attachmentOrigin=(0,h.TH)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new s.bk,this._geometry=null,this._width=1,this._color=(0,a.fA)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,a.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=8,this._attachmentOrigin.spatialReference=e.view.spatialReference,this._laserline=new m.o({view:e.view,isDecoration:e.isDecoration}),this.applyProperties(e),this.attached=e.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:R,recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)},forEachMaterial:(e,t)=>t(e.material)}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:R,recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()},forEachMaterial:(e,t)=>t(e.material)}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e,this._updateMaterial()}get geometry(){return this._geometry}set geometry(e){const t=this._isClosed;this._geometry=e,this.recreateGeometry(),t!==this._isClosed&&this._updateMaterial()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,o.a)(e,this._color)||((0,o.d)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,o.a)(e,this._innerColor)||((0,o.d)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,o.a)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,a.o8)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=this.object3dResources.resources?.geometries;if(!e||0===e.length)return null;(0,n.j)(A,0,0,0);let t=0;for(const r of e)r.computeAttachmentOrigin(b)&&((0,n.g)(A,A,b),t++);return 0===t?null:((0,n.h)(A,A,1/t),this.view.renderCoordsHelper.fromRenderCoords(A,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){this.object3dResources.resources?.material.setParameters(this._materialParameters),this.drapedResources.resources?.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&8===this._renderOccluded?4:this._renderOccluded}_recreateGeometry(e,t,r){this._createRenderGeometries(t,r);for(const s of r)e.addGeometry(s);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(e){const t=new x.W(this._materialParameters,this.view.state.isGlobal),r=new Array;return this._recreateGeometry(e,t,r),{material:t,geometries:r}}_createDrapedResources(){const e=new x.W(this._materialParameters,this.view.state.isGlobal);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:r}=this,s=r.basemapTerrain.spatialReference;return null==t||null==s?[]:(0,g.A)(t,s).lines.map(t=>{let{position:n}=t;const i={overlayInfo:{spatialReference:s,renderCoordsHelper:r.renderCoordsHelper},attributeData:{position:n},removeDuplicateStartEnd:this._isClosed};return new v.$((0,y.te)(e,i))})}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const r of this.object3dResources.resources.geometries){const s=r.attributes.get("position"),n=(0,u.jh)(s.data.length);(0,c.projectBuffer)(s.data,t.spatialReference,0,n,this.view.spatialReference,0),(0,l.Hq)(e,n)}return!0}_createRenderGeometries(e,t){const r=this.geometry;if(null==r)return;const s=(0,g.C)(r,this.view.elevationProvider,this.view.renderCoordsHelper,_.F.fromElevationInfo(this.elevationInfo??new f.A({mode:(0,d.w7)(r,null)}))),n=new Array;for(const{position:i,mapPositions:o}of s.lines){const r={mapPositions:o,attributeData:{position:i},removeDuplicateStartEnd:this._isClosed};t.push((0,y.te)(e,r)),n.push(i)}this._laserline.pathVerticalPlane=n}}function R(e){e.geometries=[]}const b=(0,i.vt)(),A=(0,i.vt)()},77176:(e,t,r)=>{r.d(t,{b:()=>i});var s=r(15941),n=r(38496);function i(e,t,r){const i=Array.isArray(e),u=i?e.length/t:e.byteLength/(4*t),h=i?e:new Uint32Array(e,0,u*t),d=r?.minReduction??0,f=r?.originalIndices||null,p=f?f.length:0,m=r?.componentOffsets||null;let _=0;if(m)for(let s=0;s<m.length-1;s++){const e=m[s+1]-m[s];e>_&&(_=e)}else _=u;const y=Math.floor(1.1*_)+1;(null==l||l.length<2*y)&&(l=new Uint32Array((0,s.cU)(2*y)));for(let s=0;s<2*y;s++)l[s]=0;let g=0;const v=!!m&&!!f,x=v?p:u;let w=(0,n.my)(u);const R=new Uint32Array(p),b=1.96;let A=0!==d?Math.ceil(4*b*b/(d*d)*d*(1-d)):x,C=1,M=m?m[1]:x;for(let s=0;s<x;s++){if(s===A){const e=1-g/s;if(e+b*Math.sqrt(e*(1-e)/s)<d)return null;A*=2}if(s===M){for(let e=0;e<2*y;e++)l[e]=0;if(f)for(let e=m[C-1];e<m[C];e++)R[e]=w[f[e]];M=m[++C]}const e=v?f[s]:s,r=e*t,n=c(h,r,t);let i=n%y,a=g;for(;0!==l[2*i+1];){if(l[2*i]===n){const e=l[2*i+1]-1;if(o(h,r,e*t,t)){a=w[e];break}}i++,i>=y&&(i-=y)}a===g&&(l[2*i]=n,l[2*i+1]=e+1,g++),w[e]=a}if(0!==d&&1-g/u<d)return null;if(v){for(let e=m[C-1];e<R.length;e++)R[e]=w[f[e]];w=(0,n.uW)(R)}const G=i?new Array(g):new Uint32Array(g*t);g=0;for(let s=0;s<x;s++)w[s]===g&&(a(h,(v?f[s]:s)*t,G,g*t,t),g++);if(f&&!v){const e=new Uint32Array(p);for(let t=0;t<e.length;t++)e[t]=w[f[t]];w=(0,n.uW)(e)}return{buffer:Array.isArray(G)?G:G.buffer,indices:w,uniqueCount:g}}function o(e,t,r,s){for(let n=0;n<s;n++)if(e[t+n]!==e[r+n])return!1;return!0}function a(e,t,r,s,n){for(let i=0;i<n;i++)r[s+i]=e[t+i]}function c(e,t,r){let s=0;for(let n=0;n<r;n++)s=e[t+n]+s|0,s=s+(s<<11)+(s>>>2)|0;return s>>>0}let l=null},80069:(e,t,r)=>{r.d(t,{F:()=>h,a:()=>f,b:()=>d});var s=r(75540),n=r(73398),i=r(21390),o=r(86955),a=r(72790),c=r(70367),l=r(31432),u=r(2687);class h extends l.Y{constructor(){super(...arguments),this.effect=0,this.fadeFactor=(0,s.v)(1)}}function d(){const e=new u.N5;return e.include(n.c),e.outputs.add("fragColor","vec4",0),e.fragment.uniforms.add(new c.N("colorTexture",e=>e.color),new c.N("focusArea",e=>e.focusArea),new a.c("focusAreaEffectMode",e=>e.effect),new i.m("fadeFactor",e=>e.fadeFactor.value)).main.add(o.H`
      float mask = texture( focusArea, uv, 0.0 ).r;
      vec4 color = texture( colorTexture, uv, 0.0 );
      vec4 colorDeSaturate = vec4(color.r * 0.25 + color.g * 0.5 + color.b * 0.25);
      if (focusAreaEffectMode == ${o.H.int(0)}) {
        fragColor = mask > 0.0 ? color : mix(color, 0.55 * colorDeSaturate + 0.45, fadeFactor);
      } else {
        fragColor = mask > 0.0 ? color : mix(color, 0.33 * color, fadeFactor);
      }
  `),e}const f=Object.freeze(Object.defineProperty({__proto__:null,FocusAreaColorPassParameters:h,build:d},Symbol.toStringTag,{value:"Module"}))},83457:(e,t,r)=>{r.d(t,{fz:()=>a,g7:()=>i,zo:()=>o});var s=r(68707);const n=new(r(20265).O);function i(e,t,r,s){return n.execute(e,t,r,s,null)}function o(e,t,r,i){const o=n.executeMany(new s.S(e),t,r,i,null);return Array.from(o)}function a(){return n.supportsCurves()}},85746:(e,t,r)=>{r.d(t,{X:()=>m});var s=r(6326),n=r(91967),i=r(5632),o=r(46053),a=(r(81806),r(76460),r(47249),r(87990));class c{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=2}destroy(){this._destroyResources()}get resources(){return this._resources?.external}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=this._resources?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new l({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=this._resourceFactory.view.overlayManager;this._resources={layerView:t,external:e,geometriesAdded:!1},r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,1),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,1),this._resources.geometriesAdded=!0))}}let l=class extends((0,i.sA)(n.A)){constructor(e){super(e),this.drapeSourceType=1,this.updatePolicy=1,this.renderGroup=2}};(0,s.Cg)([(0,o.MZ)({constructOnly:!0})],l.prototype,"view",void 0),(0,s.Cg)([(0,o.MZ)({readOnly:!0})],l.prototype,"drapeSourceType",void 0),(0,s.Cg)([(0,o.MZ)()],l.prototype,"renderGroup",void 0),l=(0,s.Cg)([(0,a.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],l);var u=r(69230),h=r(68134),d=r(37046),f=r(8918);class p{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view.stage;if(null==this._resources||!e)return;const t=this._resources.object;t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer)}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,r=t.stage;if(!r)return;const s=new f.x(r,{pickable:!1,updatePolicy:1}),n=new d.B({castShadow:!1}),i=e.createResources(n,s);s.add(n);const o=e.cameraChanged,a=o?(0,h.wB)(()=>t.state.camera,e=>o(e),h.Vh):null;this._resources={layer:s,object:n,external:i,cameraHandle:a},this._syncVisible()}_destroyResources(){null!=this._resources&&(this._resources.layer.destroy(),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null)}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class m extends u.B{constructor(e){super(e),this._isDraped=!1,this.object3dResources=new p(this.createObject3DResourceFactory(e.view)),this.drapedResources=new c(this.createDrapedResourceFactory(e.view)),this.isDraped=e.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}forEachMaterial(e){this.object3dResources?.forEachMaterial(e),this.drapedResources?.forEachMaterial(e)}}},94522:(e,t,r)=>{r.r(t),r.d(t,{FocusAreasView:()=>ee});var s=r(6326),n=r(91967),i=r(18690),o=r(19276),a=r(50076),c=r(76460),l=r(43927),u=r(68134),h=r(31633),d=r(46053),f=(r(81806),r(87990)),p=r(38983),m=r(13191),_=r(9392),y=r(34111),g=r(19247),v=r(56611),x=r(83457),w=r(50360),R=r(58067),b=r(5809),A=r(44815),C=r(14556),M=r(38496),G=r(45136),O=r(49296),P=r(16266),E=r(36423),D=r(87925),S=(r(47249),r(90364)),Z=r(36451),F=r(80069),V=r(16506),j=r(59246),k=r(11850),T=r(57162);class z extends j.w{constructor(e,t){super(e,t,new V.$(F.a,()=>r.e(81345).then(r.bind(r,81345))),k.Nx)}initializePipeline(){return(0,T.Ey)({colorWrite:T.kn})}}var I=r(93345);let N=class extends Z.A{constructor(e){super({...e,view:e.focusAreasView.view}),this.consumes={required:[S.OG.FOCUSAREA_COLOR,S.OG.FOCUSAREA]},this.produces=S.OG.FOCUSAREA_COLOR,this._fadeDirection=0,this._passParameters=new F.F}precompile(){this.techniques.precompile(z)}fadeOut(e){this.removeAllHandles(),this._startTime=null,this._fadeDirection=1,this.addHandles((0,u.wB)(()=>this._passParameters.fadeFactor.value,t=>{0===t&&(this.removeAllHandles(),e())})),this.requestRender(2)}render(e){const t=this.techniques.get(z),r=e.find(e=>{let{name:t}=e;return t===this.produces});if(!t.compiled)return this.requestRender(1),r;const s=this.focusAreasView.style,n=this.bindParameters,i=n.camera,o=i.fullViewport[2],a=i.fullViewport[3];this._startTime??=this.view.stage?.renderer.renderContext.time;const c=this.view.qualitySettings.fadeDuration,l=c>0?Math.min(c,this.view.stage?.renderer.renderContext.time-this._startTime)/c:1,u=e.find(e=>{let{name:t}=e;return t===S.OG.FOCUSAREA}),h=this.fboCache.acquire(o,a,this.produces),d=this.renderingContext;return d.bindFramebuffer(h.fbo),this._passParameters.color=r.getTexture(),this._passParameters.focusArea=u.getTexture(),this._passParameters.effect=q[s],this._passParameters.fadeFactor.value=0===this._fadeDirection?l:1-l,d.bindTechnique(t,n,this._passParameters),d.screen.draw(),h.attachDepth(r.getAttachment(I.nI)),l<1&&this.requestRender(2),h}};(0,s.Cg)([(0,d.MZ)()],N.prototype,"consumes",void 0),(0,s.Cg)([(0,d.MZ)()],N.prototype,"produces",void 0),(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],N.prototype,"focusAreasView",void 0),N=(0,s.Cg)([(0,f.$)("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaColorNode")],N);const q={bright:0,dark:1};var H=r(40366),W=r(75757);class U extends j.w{constructor(e,t){super(e,t,new V.$(H.a,()=>r.e(55698).then(r.bind(r,55698))),(0,W.Xk)(k.SL))}initializePipeline(){return(0,T.Ey)({colorWrite:T.kn,depthTest:{func:515}})}}var $=r(69008),B=r(31432),L=r(9243);let X=class extends Z.A{constructor(e){super({...e,view:e.focusAreasView.view}),this.consumes={required:[S.hM.TRANSPARENT]},this.produces=S.OG.FOCUSAREA,this._vaos=new Array,this._counts=new Array,this._origins=new Array,this._maskParameters=new H.F}initialize(){this.updateGeometries()}destroy(){this._vaos.forEach(e=>e.dispose()),this._vaos.length=this._counts.length=this._origins.length=0}precompile(){this.techniques.precompile(U)}render(e){const t=this.techniques.get(U),r=this.bindParameters,s=r.camera,n=s.fullViewport[2],i=s.fullViewport[3];if(!t.compiled||!this._vaos)return void this.requestRender(1);const o=e.find(e=>{let{name:t}=e;return t===S.hM.TRANSPARENT}),a=this.renderingContext,c=this.fboCache.acquire(n,i,S.OG.FOCUSAREA,2);this.view.stage.renderer.occludedRequiresStencil?(c.acquireDepth(13),a.blitFramebuffer(o.fbo,c.fbo,256)):c.attachDepth(o.getAttachment(I.nI)),a.bindFramebuffer(c.fbo),a.setClearColor(0,0,0,1),a.clear(17408),a.setViewport(0,0,n,i);const l=a.bindTechnique(t,r);a.setFaceCullingEnabled(!1),a.setStencilTestEnabled(!0),a.setStencilOpSeparate(1028,7680,34055,7680),a.setStencilOpSeparate(1029,7680,34056,7680),a.setDepthWriteEnabled(!1);for(let u=0;u<this._vaos.length;u++){const e=this._vaos[u],t=this._counts[u];this._maskParameters.origin=this._origins[u],l.bindDraw(r,B.m,this._maskParameters),a.bindVAO(e),a.setDepthTestEnabled(!0),a.setStencilWriteMask(255),a.setStencilFunction(519,0,255),a.setColorMask(!1,!1,!1,!1),a.drawArrays(I.WR.TRIANGLES,0,t),a.setDepthTestEnabled(!1),a.setStencilWriteMask(0),a.setStencilFunction(517,0,255),a.setColorMask(!0,!0,!0,!0),a.drawArrays(I.WR.TRIANGLES,0,t)}return c}updateGeometries(){this.view.stage&&(this._vaos.forEach(e=>e.dispose()),this._vaos.length=this._counts.length=this._origins.length=0,this.focusAreasView.volumes.forEach(e=>{const t=new Array;let r=0,s=0;e.geometryVolumes.forEach(e=>{const n=e.indicesBottom;r+=n.length;for(let r=0;r<n.length;r++)t.push(e.positions[3*(n[r]-1)]),t.push(e.positions[3*(n[r]-1)+1]),t.push(e.positions[3*(n[r]-1)+2]);const i=e.indicesExtruded;s+=i.length;for(let r=0;r<i.length;r++)t.push(e.positions[3*i[r]]),t.push(e.positions[3*i[r]+1]),t.push(e.positions[3*i[r]+2])});const n=new $.Z(this.renderingContext,new L.R(this.renderingContext,k.SL,new Float32Array(t)));this._vaos.push(n),this._counts.push(r+s),this._origins.push(e.origin)}),this.requestRender(1))}};(0,s.Cg)([(0,d.MZ)()],X.prototype,"consumes",void 0),(0,s.Cg)([(0,d.MZ)()],X.prototype,"produces",void 0),(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],X.prototype,"focusAreasView",void 0),X=(0,s.Cg)([(0,f.$)("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaMaskNode")],X);var Y=r(69539),J=r(30726),Q=r(73074);let K=class extends n.A{constructor(e){super(e)}initialize(){this.addHandles([(0,u.wB)(()=>this.area.enabled,()=>this._ensureElement(),u.Vh),(0,u.wB)(()=>this.area.outline?.color,e=>this._updateColor(e),u.Vh),(0,u.wB)(()=>this.area.geometries,e=>this._updateGeometries(e),u.Vh)])}destroy(){this.removeAllHandles(),this._outlineElement=(0,J.pR)(this._outlineElement)}_ensureElement(){this.area.enabled&&this.area.outline?.color?this._outlineElement??=new Q.P({view:this.view,geometry:this._mergePolygons(this.area.geometries),isDraped:!0,attached:!0,isDecoration:!1,color:Y.A.toUnitRGBA(this.area.outline?.color),renderOccluded:4,width:3}):this._outlineElement=(0,J.pR)(this._outlineElement)}_updateGeometries(e){this._ensureElement(),this._outlineElement&&(this._outlineElement.geometry=this._mergePolygons(e))}_updateColor(e){this._ensureElement(),this._outlineElement&&e&&(this._outlineElement.color=Y.A.toUnitRGBA(e))}_mergePolygons(e){if(!e||0===e.length)return null;const t=e.at(0).clone();return t.rings.length=0,e.forEach(e=>t.rings.push(...e.rings)),t}};(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],K.prototype,"view",void 0),(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],K.prototype,"area",void 0),K=(0,s.Cg)([(0,f.$)("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaOutlineItem")],K);let ee=class extends n.A{constructor(e){super(e),this._volumes=new Map,this._elevationContext=new O.F,this._outlineMap=new o.A}initialize(){this.addHandles([(0,u.wB)(()=>({polygons:this.polygons,ready:this.view.basemapTerrain?.ready}),e=>{let{polygons:t,ready:r}=e;r&&this._updateVolumes(t)},u.Vh)]),this._outlineMap=(0,l.L)(()=>this.areas?.areas,e=>new K({area:e,view:this.view}),{recycleItems:!0})}destroy(){this.removeAllHandles(),this._outlineMap.destroy()}get areas(){return this.view.map?.focusAreas}get enabledAreas(){return this.areas?.areas.toArray().filter(e=>{let{enabled:t}=e;return t})??[]}get style(){return this.areas?.style??"bright"}get polygons(){return this.enabledAreas.reduce((e,t)=>e.concat(t.geometries.toArray()),new Array)}containsGeometry(e){if(0===this.polygons.length)return!0;const t=new g.A(e);return this.polygons.some(e=>e.contains(t))}_updateVolumes(e){this._extrude(e),this._ensureRenderNodes()}_extrude(e){if(!this.view.renderCoordsHelper||(0,i.aI)(Array.from(this._volumes.keys()),e))return;const t=this.view.renderCoordsHelper,r=(0,_.vt)(),s=1===t.viewingMode,n=(0,m.vt)(),o=(0,m.vt)(),l=this.view.spatialReference,u=(0,R.fromSpatialReference)(l),d=(0,y.tO)(l).radius/C.$O.radius,f=(0,h.UW)(5e5*d,"meters",l,!0);s||t.worldUpAtPosition([0,0,0],r);const g=new Map;for(const i of e){const e=this._volumes.get(i);if(e)g.set(i,e);else try{const e=l.equals(i.spatialReference)?i:(0,v.project)(i,l),a=Math.max(e.extent.width,e.extent.height),c=(0,h.PQ)(a,l,"meters",!0),m=Math.max(5*c,2e4*d),_=s?d/10:d,y=this._reduceGeometryHeight(e,m,_),C=(0,E.W$)(y);if(null==C)continue;const O=(0,R.fromPolygon)(y),S=(0,w.g7)(O,u,!1)??O,Z=(0,x.g7)(S,f,0,0),F=(0,R.toPolygon)(Z,l);if(null==F)continue;(0,b.l)(l,[C.x,C.y,0],n,t.spatialReference),o[12]=-n[12],o[13]=-n[13],o[14]=-n[14];const V=(0,D.C8)(F,this.view.elevationProvider,t,this._elevationContext),{polygons:j,mapPositions:k,position:T}=V,z=new Array,I=new te(z,[n[12],n[13],n[14]]);for(const t of j){const e=t.count,n=(0,p.e)(t.mapPositions,t.holeIndices,3);if(0===n.length)continue;const i=n.length,a=6*e,c=a+i,l=(0,A.jh)(3*a),u=(0,M.my)(c),h=(0,M.my)(i);(0,P.K)(T,k,n,t,l,null,null,null,u,h,m,r,s),(0,G.t)(l,l,o);const d=new re(l,h,u,m);z.push(d)}g.set(i,I)}catch(O){c.A.getLogger(this).error(new a.A("focusareasview:projection-failed","Failed to project focus area geometry to view spatial reference",{geometry:i,error:O}))}}this._volumes=g,0!==this.volumes.size&&this._maskRenderNode?.updateGeometries()}_ensureRenderNodes(){if(this.view.stage)if(0===this.volumes.size){const{_maskRenderNode:e,_colorRenderNode:t}=this;this._maskRenderNode=this._colorRenderNode=null,t?.fadeOut(()=>{e?.destroy(),t?.destroy()})}else this._maskRenderNode??=new X({focusAreasView:this}),this._colorRenderNode??=new N({focusAreasView:this}),this.view.stage.renderView.requestRender()}_reduceGeometryHeight(e,t,r){const s=-12e5*r,n=Math.max(-t/2,s),i=e.rings.map(e=>e.map(e=>[e[0],e[1],n])),o=e.clone();return o.rings=i,o.hasZ=!0,o}get volumes(){return this._volumes}};(0,s.Cg)([(0,d.MZ)()],ee.prototype,"_volumes",void 0),(0,s.Cg)([(0,d.MZ)({constructOnly:!0})],ee.prototype,"view",void 0),ee=(0,s.Cg)([(0,f.$)("esri.views.3d.FocusAreasView")],ee);class te{constructor(e,t){this.geometryVolumes=e,this.origin=t}}class re{constructor(e,t,r,s){this.positions=e,this.indicesBottom=t,this.indicesExtruded=r,this.height=s}}},99785:(e,t,r)=>{r.d(t,{lO:()=>l,oR:()=>u});var s=r(38983),n=r(5262),i=r(44815),o=r(38496),a=r(10294),c=r(77176);function l(e){const t=u(e.rings,e.hasZ,1,e.spatialReference),r=new Array;let n=0,a=0;for(const c of t.polygons){const e=c.count,l=c.index,u=(0,i.l5)(t.position,3*l,3*e),h=c.holeIndices.map(e=>e-l),d=(0,o.uW)((0,s.e)(u,h,3));r.push({position:u,faces:d}),n+=u.length,a+=d.length}const l=function(e,t,r){if(1===e.length)return e[0];const s=(0,i.jh)(t),n=new Array(r);let a=0,c=0,l=0;for(const i of e){for(let e=0;e<i.position.length;e++)s[a++]=i.position[e];for(const e of i.faces)n[c++]=e+l;l=a/3}return{position:s,faces:(0,o.uW)(n)}}(r,n,a),h=Array.isArray(l.position)?(0,c.b)(l.position,3,{originalIndices:l.faces}):(0,c.b)(l.position.buffer,6,{originalIndices:l.faces});return l.position=(0,i.xm)(new Float64Array(h.buffer)),l.faces=h.indices,l}function u(e,t,r,s){const n=e.length,o=new Array(n),a=new Array(n),c=new Array(n);let l=0;for(let i=0;i<n;++i)l+=e[i].length;let u=0,f=0,p=0;const m=(0,i.jh)(3*l);let _=0;for(let i=n-1;i>=0;i--){const l=e[i],y=1===r&&d(l,t,s);if(y&&1!==n)o[u++]=l;else{let e=l.length;for(let t=0;t<u;++t)e+=o[t].length;const r={index:_,pathLengths:new Array(u+1),count:e,holeIndices:new Array(u)};r.pathLengths[0]=l.length,l.length>0&&(c[p++]={index:_,count:l.length}),_=y?h(l,l.length-1,-1,m,_,l.length,t):h(l,0,1,m,_,l.length,t);for(let s=0;s<u;++s){const e=o[s];r.holeIndices[s]=_,r.pathLengths[s+1]=e.length,e.length>0&&(c[p++]={index:_,count:e.length}),_=h(e,0,1,m,_,e.length,t)}u=0,r.count>0&&(a[f++]=r)}}for(let i=0;i<u;++i){const e=o[i];e.length>0&&(c[p++]={index:_,count:e.length}),_=h(e,0,1,m,_,e.length,t)}return a.length=f,c.length=p,{position:m,polygons:a,outlines:c}}function h(e,t,r,s,n,i,o){n*=3;for(let a=0;a<i;++a){const i=e[t];s[n++]=i[0],s[n++]=i[1],s[n++]=o&&i[2]?i[2]:0,t+=r}return n/3}function d(e,t,r){if(!t)return!(0,n.$3)(e);const s=e.length-1;switch((0,a.S)(e,s,r)){case 0:return!(0,n.$3)(e,1,2);case 1:return!(0,n.$3)(e,0,2);case 2:return!(0,n.$3)(e,0,1)}}}}]);
//# sourceMappingURL=53154.3a9cce8f.chunk.js.map