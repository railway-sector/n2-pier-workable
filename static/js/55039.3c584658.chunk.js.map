{"version":3,"file":"static/js/55039.3c584658.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/rest/query/operations/query.js","../node_modules/@arcgis/core/layers/support/StreamConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/WebSocketConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/GeoEventConnection.js","../node_modules/@arcgis/core/layers/support/ClientSideConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/createConnection.js","../node_modules/@arcgis/core/rest/operations/urlUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport e from\"../../../request.js\";import{urlToObject as t,join as r}from\"../../../core/urlUtils.js\";import{getJsonType as n}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as i}from\"../../../geometry/support/normalizeUtils.js\";import{srToRESTValue as o}from\"../../../geometry/support/spatialReferenceUtils.js\";import{mapParameters as a}from\"../../operations/urlUtils.js\";import{parsePBFFeatureQuery as s}from\"./pbfQueryUtils.js\";import{applyFeatureSetZUnitScaling as u}from\"./queryZScale.js\";const l=\"Layer does not support extent calculation.\";function d(e,t){if(t&&\"extent\"===e.type)return`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;if(t&&\"point\"===e.type)return`${e.x},${e.y}`;const r=e.toJSON();return delete r.spatialReference,JSON.stringify(r)}function y(e,t,r){const i=e.geometry,a=e.toJSON();delete a.compactGeometryEnabled,delete a.defaultSpatialReferenceEnabled;const s=a;let u,l,y;if(i&&(l=i.spatialReference,y=o(l),s.geometryType=n(i),s.geometry=d(i,e.compactGeometryEnabled),s.inSR=y),a.groupByFieldsForStatistics&&(s.groupByFieldsForStatistics=a.groupByFieldsForStatistics.join(\",\")),a.objectIds)switch(r?.uniqueIdFields?.length){case void 0:s.objectIds=a.objectIds.join(\",\");break;case 1:s.uniqueIds=JSON.stringify(a.objectIds),delete s.objectIds;break;default:s.uniqueIds=JSON.stringify(a.objectIds.map((e=>JSON.parse(e)))),delete s.objectIds}if(a.orderByFields&&(s.orderByFields=a.orderByFields.join(\",\")),!a.outFields||!a.returnDistinctValues&&(t?.returnCountOnly||t?.returnExtentOnly||t?.returnIdsOnly)?delete s.outFields:a.outFields.includes(\"*\")?s.outFields=\"*\":s.outFields=a.outFields.join(\",\"),a.outSR?(s.outSR=o(a.outSR),u=e.outSpatialReference):i&&(a.returnGeometry||a.returnCentroid)&&(s.outSR=s.inSR,u=l),a.returnGeometry&&delete a.returnGeometry,a.outStatistics&&(s.outStatistics=JSON.stringify(a.outStatistics)),a.fullText&&(s.fullText=JSON.stringify(a.fullText)),a.pixelSize&&(s.pixelSize=JSON.stringify(a.pixelSize)),a.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&null!=l&&null!=e.quantizationParameters?.extent&&l.equals(e.quantizationParameters.extent.spatialReference)&&delete a.quantizationParameters.extent.spatialReference,s.quantizationParameters=JSON.stringify(a.quantizationParameters)),a.parameterValues&&(s.parameterValues=JSON.stringify(a.parameterValues)),a.rangeValues&&(s.rangeValues=JSON.stringify(a.rangeValues)),a.dynamicDataSource&&(s.layer=JSON.stringify({source:a.dynamicDataSource}),delete a.dynamicDataSource),a.timeExtent){const e=a.timeExtent,{start:t,end:r}=e;null==t&&null==r||(s.time=t===r?t:`${t??\"null\"},${r??\"null\"}`),delete a.timeExtent}return e.defaultSpatialReferenceEnabled&&null!=l&&null!=u&&l.equals(u)&&(s.defaultSR=s.inSR,delete s.inSR,delete s.outSR),s}async function c(e,t,r,n,i){const o=t.timeExtent?.isEmpty?{data:{features:[]}}:await g(e,t,\"json\",n,void 0,i);return u(t,r,o.data),o}async function f(e,t,r,n,i){if(t.timeExtent?.isEmpty)return{data:r.createFeatureResult()};const o=await m(e,t,n,i),a=o;return a.data=s(o.data,r),a}function m(e,t,r,n){return g(e,t,\"pbf\",r,void 0,n)}function p(e,t,r,n){return t.timeExtent?.isEmpty?Promise.resolve({data:{objectIds:[]}}):g(e,t,\"json\",r,{returnIdsOnly:!0},n)}function S(e,t,r,n){return t.timeExtent?.isEmpty?Promise.resolve({data:{count:0}}):g(e,t,\"json\",r,{returnIdsOnly:!0,returnCountOnly:!0},n)}async function O(e,t,r){if(t.timeExtent?.isEmpty)return{data:{count:0,extent:null}};const n=await g(e,t,\"json\",r,{returnExtentOnly:!0,returnCountOnly:!0}),i=n.data;if(i.hasOwnProperty(\"extent\"))return n;if(i.features)throw new Error(l);if(i.hasOwnProperty(\"count\"))throw new Error(l);return n}function x(e,t){if(!e.returnIdsOnly||!t.uniqueIdFields)return e;const r={...e,returnUniqueIdsOnly:!0};return delete r.returnIdsOnly,r}async function g(n,o,s,u={},l={},d={}){const c=\"string\"==typeof n?t(n):n,f=o.geometry?[o.geometry]:[],m=await i(f,null,{signal:u.signal}),p=m?.[0];null!=p&&((o=o.clone()).geometry=p);const S=a({...c.query,f:s,...x(l,d),...y(o,l,d)});return e(r(c.path,j(o,l)?\"query3d\":\"query\"),{...u,responseType:\"pbf\"===s?\"array-buffer\":\"json\",query:{...S,...u.query}})}function j(e,t){return null!=e.formatOf3DObjects&&!(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)}export{d as encodeGeometry,c as executeQuery,S as executeQueryForCount,O as executeQueryForExtent,p as executeQueryForIds,f as executeQueryPBF,m as executeQueryPBFBuffer,y as queryToQueryStringParameters,g as runQuery};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Error.js\";import o from\"../../core/Evented.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";let c=class extends o.EventedAccessor{destroy(){this.emit(\"destroy\")}get connectionError(){return this.errorString?new e(\"stream-connection\",this.errorString):null}onFeature(r){this.emit(\"data-received\",r)}onMessage(r){this.emit(\"message-received\",r)}};r([t({readOnly:!0})],c.prototype,\"connectionError\",null),c=r([s(\"esri.layers.support.StreamConnection\")],c);export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Error.js\";import o from\"../../../../core/Logger.js\";import{after as s,createResolver as r}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as n}from\"../../../../core/urlUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as c}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as a}from\"../../../../geometry/support/zscale.js\";import l from\"../../../support/StreamConnection.js\";var h;!function(e){e[e.CONNECTING=0]=\"CONNECTING\",e[e.OPEN=1]=\"OPEN\",e[e.CLOSING=2]=\"CLOSING\",e[e.CLOSED=3]=\"CLOSED\"}(h||(h={}));let d=class extends l{constructor(e){super({}),this._outstandingMessages=[],this.errorString=null;const{geometryType:t,spatialReference:o,sourceSpatialReference:s}=e;this._config=e,this._featureZScaler=a(t,s,o),this._open()}normalizeCtorArgs(){return{}}async _open(){await this._tryCreateWebSocket(),this.destroyed||await this._handshake()}destroy(){super.destroy(),null!=this._websocket&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null}get connectionStatus(){if(null==this._websocket)return\"disconnected\";switch(this._websocket.readyState){case h.CONNECTING:case h.OPEN:return\"connected\";case h.CLOSING:case h.CLOSED:return\"disconnected\"}}sendMessageToSocket(e){null!=this._websocket?this._websocket.send(JSON.stringify(e)):this._outstandingMessages.push(e)}sendMessageToClient(e){this._onMessage(e)}updateCustomParameters(e){this._config.customParameters=e,null!=this._websocket&&this._websocket.close()}async _tryCreateWebSocket(e=this._config.source.path,r=1e3,i=0){try{if(this.destroyed)return;const t=n(e,this._config.customParameters??{});this._websocket=await this._createWebSocket(t),this.notifyChange(\"connectionStatus\")}catch(c){const n=r/1e3;return this._config.maxReconnectionAttempts&&i>=this._config.maxReconnectionAttempts?(o.getLogger(this).error(new t(\"websocket-connection\",\"Exceeded maxReconnectionAttempts attempts. No further attempts will be made\")),void this.destroy()):(o.getLogger(this).error(new t(\"websocket-connection\",`Failed to connect. Attempting to reconnect in ${n}s`,c)),await s(r),this._tryCreateWebSocket(e,Math.min(1.5*r,1e3*this._config.maxReconnectionInterval),i+1))}}_setWebSocketJSONParseHandler(e){e.onmessage=e=>{try{const t=JSON.parse(e.data);this._onMessage(t)}catch(s){return void o.getLogger(this).error(new t(\"websocket-connection\",\"Failed to parse message, invalid JSON\",{error:s}))}}}_createWebSocket(e){return new Promise(((t,o)=>{const s=new WebSocket(e);s.onopen=()=>{if(s.onopen=null,this.destroyed)return s.onclose=null,void s.close();s.onclose=e=>this._onClose(e),s.onerror=e=>this._onError(e),this._setWebSocketJSONParseHandler(s),t(s)},s.onclose=e=>{s.onopen=s.onclose=null,o(e)}}))}async _handshake(e=1e4){const s=this._websocket;if(null==s)return;const n=r(),i=s.onmessage,{filter:c,outFields:a,spatialReference:l}=this._config;return n.timeout(e),s.onmessage=e=>{let r=null;try{r=JSON.parse(e.data)}catch(h){}r&&\"object\"==typeof r||(o.getLogger(this).error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - malformed message\",e.data)),n.reject(),this.destroy()),r.spatialReference?.wkid!==l?.wkid&&(o.getLogger(this).error(new t(\"websocket-connection\",`Protocol violation. Handshake failed - expected wkid of ${l.wkid}`,e.data)),n.reject(),this.destroy()),\"json\"!==r.format&&(o.getLogger(this).error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - format is not set\",e.data)),n.reject(),this.destroy()),c&&r.filter!==c&&o.getLogger(this).error(new t(\"websocket-connection\",\"Tried to set filter, but server doesn't support it\")),a&&r.outFields!==a&&o.getLogger(this).error(new t(\"websocket-connection\",\"Tried to set outFields, but server doesn't support it\")),s.onmessage=i;for(const t of this._outstandingMessages)s.send(JSON.stringify(t));this._outstandingMessages=[],n.resolve()},s.send(JSON.stringify({filter:c,outFields:a,format:\"json\",spatialReference:{wkid:l.wkid}})),n.promise}_onMessage(e){if(this.onMessage(e),\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const t of e.features)null!=this._featureZScaler&&this._featureZScaler(t.geometry),this.onFeature(t)}}_onError(e){const t=\"Encountered an error over WebSocket connection\";this._set(\"errorString\",t),o.getLogger(this).error(\"websocket-connection\",t)}_onClose(e){this._websocket=null,this.notifyChange(\"connectionStatus\"),1e3!==e.code&&o.getLogger(this).error(\"websocket-connection\",`WebSocket closed unexpectedly with error code ${e.code}`),this.destroyed||this._open()}};e([i()],d.prototype,\"connectionStatus\",null),e([i()],d.prototype,\"errorString\",void 0),d=e([c(\"esri.layers.graphics.sources.connections.WebSocketConnection\")],d);export{d as WebSocketConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../request.js\";import r from\"../../../../core/Error.js\";import i from\"../../../../core/Logger.js\";import{createResolver as o}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as s}from\"../../../../core/urlUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../../geometry/SpatialReference.js\";import{fromJSON as c}from\"../../../../geometry/support/jsonUtils.js\";import{WebSocketConnection as u}from\"./WebSocketConnection.js\";import{executeQuery as l}from\"../../../../rest/query/operations/query.js\";import f from\"../../../../rest/support/Query.js\";const h=1e4,d={maxQueryDepth:5,maxRecordCountFactor:3};let g=class extends u{constructor(e){super({...d,...e}),this._buddyServicesQuery=null,this._relatedFeatures=null}async _open(){const e=await this._fetchServiceDefinition(this._config.source);e.timeInfo.trackIdField||i.getLogger(this).warn(\"GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.\");const t=this._fetchWebSocketUrl(e.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),await this._buddyServicesQuery,await this._tryCreateWebSocket(t);const{filter:r,outFields:o}=this._config;this.destroyed||this._setFilter(r,o)}_onMessage(e){if(\"attributes\"in e){let o;try{o=this._enrich(e),null!=this._featureZScaler&&this._featureZScaler(o.geometry)}catch(t){return void i.getLogger(this).error(new r(\"geoevent-connection\",\"Failed to parse message\",t))}this.onFeature(o)}else this.onMessage(e)}async _fetchServiceDefinition(e){const r={f:\"json\",...this._config.customParameters},i=t(e.path,{query:r,responseType:\"json\"}),o=(await i).data;return this._serviceDefinition=o,o}_fetchWebSocketUrl(e,t){const r=e[0],{urls:i,token:o}=r,n=this._inferWebSocketBaseUrl(i);return s(`${n}/subscribe`,{outSR:\"\"+t.wkid,token:o})}_inferWebSocketBaseUrl(e){if(1===e.length)return e[0];for(const t of e)if(t.includes(\"wss\"))return t;return i.getLogger(this).error(new r(\"geoevent-connection\",\"Unable to infer WebSocket url\",e)),null}async _setFilter(e,t){const s=this._websocket;if(null==s||null==e&&null==t)return;const n=JSON.stringify({filter:this._serializeFilter(e,t)});let a=!1;const c=o(),u=()=>{a||(this.destroyed||this._websocket!==s||i.getLogger(this).error(new r(\"geoevent-connection\",\"Server timed out when setting filter\")),c.reject())},l=e=>{const t=JSON.parse(e.data);t.filter&&(t.error&&(i.getLogger(this).error(new r(\"geoevent-connection\",\"Failed to set service filter\",t.error)),this._set(\"errorString\",`Could not set service filter - ${t.error}`),c.reject(t.error)),this._setWebSocketJSONParseHandler(s),a=!0,c.resolve())};return s.onmessage=l,s.send(n),setTimeout(u,h),c.promise}_serializeFilter(e,t){const o={};if(null==e&&null==t)return o;if(e?.geometry)try{const t=c(e.geometry);if(\"extent\"!==t.type)throw new r(\"geoevent-connection\",`Expected extent but found type ${t.type}`);o.geometry=JSON.stringify(t.shiftCentralMeridian())}catch(s){i.getLogger(this).error(new r(\"geoevent-connection\",\"Encountered an error when setting connection geometryDefinition\",s))}return e?.where&&\"1 = 1\"!==e.where&&\"1=1\"!==e.where&&(o.where=e.where),null!=t&&(o.outFields=t.join(\",\")),o}_enrich(e){if(!this._relatedFeatures)return e;const t=this._serviceDefinition.relatedFeatures.joinField,o=e.attributes[t],s=this._relatedFeatures.get(o);if(!s)return i.getLogger(this).warn(\"geoevent-connection\",\"Feature join failed. Is the join field configured correctly?\",e),e;const{attributes:n,geometry:a}=s;for(const r in n)e.attributes[r]=n[r];return a&&(e.geometry=a),e.geometry||e.centroid||i.getLogger(this).error(new r(\"geoevent-connection\",\"Found malformed feature - no geometry found\",e)),e}async _queryBuddyServices(){try{const{relatedFeatures:e,keepLatestArchive:t}=this._serviceDefinition,r=this._queryRelatedFeatures(e),i=this._queryArchive(t);await r;const o=await i;if(!o)return;for(const s of o.features)this.onFeature(this._enrich(s))}catch(e){i.getLogger(this).error(new r(\"geoevent-connection\",\"Encountered an error when querying buddy services\",{error:e}))}}async _queryRelatedFeatures(e){if(!e)return;const t=await this._queryBuddy(e.featuresUrl);this._addRelatedFeatures(t)}async _queryArchive(e){if(e)return this._queryBuddy(e.featuresUrl)}async _queryBuddy(e){const t=new((await import(\"../../../FeatureLayer.js\")).default)({url:e}),{capabilities:r}=await t.load(),i=r.query.supportsMaxRecordCountFactor,o=r.query.supportsPagination,s=r.query.supportsCentroid,n=this._config.maxRecordCountFactor,c=t.capabilities.query.maxRecordCount,u=i?c*n:c,h=new f;if(h.outFields=this._config.outFields??[\"*\"],h.where=this._config.filter?.where??\"1=1\",h.returnGeometry=!0,h.returnExceededLimitFeatures=!0,h.outSpatialReference=a.fromJSON(this._config.spatialReference),s&&(h.returnCentroid=!0),i&&(h.maxRecordCountFactor=n),o)return h.num=u,t.destroy(),this._queryPages(e,h);const d=await l(e,h,this._config.sourceSpatialReference);return t.destroy(),d.data}async _queryPages(e,t,r=[],i=0){t.start=null!=t.num?i*t.num:null;const{data:o}=await l(e,t,this._config.sourceSpatialReference);return o.exceededTransferLimit&&i<(this._config.maxQueryDepth??0)?(o.features.forEach((e=>r.push(e))),this._queryPages(e,t,r,i+1)):(r.forEach((e=>o.features.push(e))),o)}_addRelatedFeatures(e){const t=new Map,r=e.features,i=this._serviceDefinition.relatedFeatures.joinField;for(const o of r){const e=o.attributes[i];t.set(e,o)}this._relatedFeatures=t}};g=e([n(\"esri.layers.graphics.sources.connections.GeoEventConnection\")],g);export{g as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as o}from\"../../geometry/support/zscale.js\";import s from\"./StreamConnection.js\";let a=class extends s{constructor(e){super({}),this.connectionStatus=\"connected\",this.errorString=null;const{geometryType:r,spatialReference:t,sourceSpatialReference:s}=e;this._featureZScaler=o(r,s,t)}normalizeCtorArgs(){return{}}updateCustomParameters(e){}sendMessageToSocket(e){}sendMessageToClient(e){if(\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const r of e.features)null!=this._featureZScaler&&this._featureZScaler(r.geometry),this.onFeature(r)}this.onMessage(e)}};e([r()],a.prototype,\"connectionStatus\",void 0),e([r()],a.prototype,\"errorString\",void 0),a=e([t(\"esri.layers.support.ClientSideConnection\")],a);export{a as ClientSideConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport e from\"./GeoEventConnection.js\";import{WebSocketConnection as t}from\"./WebSocketConnection.js\";import{ClientSideConnection as n}from\"../../../support/ClientSideConnection.js\";function o(e,t){if(null==e&&null==t)return null;const n={};return null!=t&&(n.geometry=t),null!=e&&(n.where=e),n}function r(r,i,s,c,l,u,a,m,p){const f={source:r,sourceSpatialReference:i,spatialReference:s,geometryType:c,filter:o(l,u),maxReconnectionAttempts:a,maxReconnectionInterval:m,customParameters:p};if(!r)return new n(f);return r.path.startsWith(\"wss://\")||r.path.startsWith(\"ws://\")?new t(f):new e(f)}export{r as createConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nfunction t(n){const o={};for(const e in n){if(\"declaredClass\"===e)continue;const r=n[e];if(null!=r&&\"function\"!=typeof r)if(Array.isArray(r)){o[e]=[];for(let n=0;n<r.length;n++)o[e][n]=t(r[n])}else\"object\"==typeof r?r.toJSON&&(o[e]=JSON.stringify(r)):o[e]=r}return o}export{t as mapParameters};\n"],"names":["l","y","e","t","r","i","geometry","a","toJSON","compactGeometryEnabled","defaultSpatialReferenceEnabled","s","u","spatialReference","o","geometryType","n","type","xmin","ymin","xmax","ymax","x","JSON","stringify","d","inSR","groupByFieldsForStatistics","join","objectIds","uniqueIdFields","length","uniqueIds","map","parse","orderByFields","outFields","returnDistinctValues","returnCountOnly","returnExtentOnly","returnIdsOnly","includes","outSR","outSpatialReference","returnGeometry","returnCentroid","outStatistics","fullText","pixelSize","quantizationParameters","extent","equals","parameterValues","rangeValues","dynamicDataSource","layer","source","timeExtent","start","end","time","defaultSR","async","c","isEmpty","data","features","g","f","createFeatureResult","m","p","Promise","resolve","S","count","O","hasOwnProperty","Error","returnUniqueIdsOnly","arguments","undefined","signal","clone","query","path","formatOf3DObjects","responseType","EventedAccessor","destroy","this","emit","connectionError","errorString","onFeature","onMessage","h","readOnly","prototype","CONNECTING","OPEN","CLOSING","CLOSED","constructor","super","_outstandingMessages","sourceSpatialReference","_config","_featureZScaler","_open","normalizeCtorArgs","_tryCreateWebSocket","destroyed","_handshake","_websocket","onopen","onclose","onerror","onmessage","close","connectionStatus","readyState","sendMessageToSocket","send","push","sendMessageToClient","_onMessage","updateCustomParameters","customParameters","_createWebSocket","notifyChange","maxReconnectionAttempts","getLogger","error","Math","min","maxReconnectionInterval","_setWebSocketJSONParseHandler","WebSocket","_onClose","_onError","filter","timeout","reject","wkid","format","promise","_set","code","maxQueryDepth","maxRecordCountFactor","_buddyServicesQuery","_relatedFeatures","_fetchServiceDefinition","timeInfo","trackIdField","warn","_fetchWebSocketUrl","streamUrls","_queryBuddyServices","_setFilter","_enrich","_serviceDefinition","urls","token","_inferWebSocketBaseUrl","_serializeFilter","setTimeout","shiftCentralMeridian","where","relatedFeatures","joinField","attributes","get","centroid","keepLatestArchive","_queryRelatedFeatures","_queryArchive","_queryBuddy","featuresUrl","_addRelatedFeatures","default","url","capabilities","load","supportsMaxRecordCountFactor","supportsPagination","supportsCentroid","maxRecordCount","returnExceededLimitFeatures","fromJSON","num","_queryPages","exceededTransferLimit","forEach","Map","set","startsWith","Array","isArray"],"sourceRoot":""}