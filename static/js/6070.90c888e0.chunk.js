"use strict";(self.webpackChunkn2_pier_workable=self.webpackChunkn2_pier_workable||[]).push([[6070],{11668:(e,a,t)=>{t.d(a,{K:()=>f,Q:()=>l});var n=t(31933),r=t(67061);const i=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function l(e,a){const{loadContext:t,...i}=a||{},l=t?await t.fetchServiceMetadata(e,i):await(0,r.V)(e,i),s=(0,n.G$)();d(l),o(l);const y={serviceJSON:l,preferredHost:s};if((l.currentVersion??0)<10.5)return y;const c=`${(0,n.$x)()??e}/layers`,u=t?await t.fetchServiceMetadata(c,i):await(0,r.V)(c,i);return d(u),o(u),y.layersJSON={layers:u.layers,tables:u.tables},y}function s(e){const{type:a}=e;return!!a&&i.has(a)}function y(e){return"Table"===e.type}function o(e){e.layers=e.layers?.filter(s),e.tables=e.tables?.filter(y)}function c(e){e.type||="Feature Layer"}function u(e){e.type||="Table"}function d(e){e.layers?.forEach(c),e.tables?.forEach(u)}function f(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}},39323:(e,a,t)=>{t.d(a,{L:()=>c});var n=t(55171),r=t(3825),i=t(50076),l=t(50346),s=t(13096),y=t(65308),o=t(70652);async function c(e,a){const t=(0,s.qg)(e);if(!t)throw new i.A("invalid-url","Invalid scene service url");const c={...a,sceneServerUrl:t.url.path,layerId:t.sublayer??void 0};if(c.sceneLayerItem??=await async function(e){const a=(await u(e)).serviceItemId;if(!a)return null;const t=new o.default({id:a,apiKey:e.apiKey}),i=await async function(e){const a=n.id?.findServerInfo(e.sceneServerUrl);if(a?.owningSystemUrl)return a.owningSystemUrl;const t=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const a=(await(0,r.A)(t,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(f){(0,l.QP)(f)}return null}(e);null!=i&&(t.portal=new y.A({url:i}));try{return await t.load({signal:e.signal})}catch(w){return(0,l.QP)(w),null}}(c),null==c.sceneLayerItem)return d(c.sceneServerUrl.replace("/SceneServer","/FeatureServer"),c);const f=await async function(e){let{sceneLayerItem:a,signal:t}=e;if(!a)return null;try{const e=(await a.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:t})).find(e=>"Feature Service"===e.type)||null;if(!e)return null;const n=new o.default({portal:e.portal,id:e.id});return await n.load(),n}catch(n){return(0,l.QP)(n),null}}(c);if(!f?.url)throw new i.A("related-service-not-found","Could not find feature service through portal item relationship");c.featureServiceItem=f;const w=await d(f.url,c);return w.portalItem=f,w}async function u(e){if(e.rootDocument)return e.rootDocument;const a={query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:e.signal};try{const t=await(0,r.A)(e.sceneServerUrl,a);e.rootDocument=t.data}catch{e.rootDocument={}}return e.rootDocument}async function d(e,a){const t=(0,s.qg)(e);if(!t)throw new i.A("invalid-feature-service-url","Invalid feature service url");const n=t.url.path,l=a.layerId;if(null==l)return{serverUrl:n};const y=u(a),o=a.featureServiceItem?await a.featureServiceItem.fetchData("json"):null,c=(o?.layers?.[0]||o?.tables?.[0])?.customParameters,d=e=>{const t={query:{f:"json",...c},responseType:"json",authMode:e,signal:a.signal};return(0,r.A)(n,t)},f=d("anonymous").catch(()=>d("no-prompt")),[w,h]=await Promise.all([f,y]),L=h?.layers,b=w.data&&w.data.layers;if(!Array.isArray(b))throw new Error("expected layers array");if(Array.isArray(L)){for(let r=0;r<Math.min(L.length,b.length);r++)if(L[r].id===l)return{serverUrl:n,layerId:b[r].id}}else if(null!=l&&l<b.length)return{serverUrl:n,layerId:b[l].id};throw new Error("could not find matching associated sublayer")}},62487:(e,a,t)=>{t.d(a,{S:()=>n});const n={BingMapsLayer:async()=>(await t.e(13993).then(t.bind(t,13993))).default,BuildingSceneLayer:async()=>(await Promise.all([t.e(74279),t.e(57236),t.e(69975)]).then(t.bind(t,82347))).default,CSVLayer:async()=>(await t.e(1365).then(t.bind(t,1365))).default,CatalogLayer:async()=>(await Promise.all([t.e(72003),t.e(89122),t.e(38911),t.e(17872),t.e(14148),t.e(84397)]).then(t.bind(t,84397))).default,DimensionLayer:async()=>(await t.e(70126).then(t.bind(t,70126))).default,ElevationLayer:async()=>(await t.e(23875).then(t.bind(t,23875))).default,FeatureLayer:async()=>(await Promise.resolve().then(t.bind(t,38451))).default,GeoJSONLayer:async()=>(await t.e(50709).then(t.bind(t,50709))).default,GeoRSSLayer:async()=>(await t.e(52551).then(t.bind(t,52551))).default,GroupLayer:async()=>(await Promise.all([t.e(60239),t.e(16095)]).then(t.bind(t,16095))).default,ImageryLayer:async()=>(await Promise.all([t.e(89122),t.e(93092),t.e(76964),t.e(18307),t.e(92826),t.e(43052)]).then(t.bind(t,43052))).default,ImageryTileLayer:async()=>(await Promise.all([t.e(59844),t.e(93092),t.e(76964),t.e(18307),t.e(81633),t.e(92826),t.e(47933),t.e(49237)]).then(t.bind(t,49237))).default,IntegratedMesh3DTilesLayer:async()=>(await t.e(76790).then(t.bind(t,76790))).default,IntegratedMeshLayer:async()=>(await t.e(35950).then(t.bind(t,35950))).default,KMLLayer:async()=>(await t.e(41324).then(t.bind(t,41324))).default,KnowledgeGraphLayer:async()=>(await Promise.all([t.e(99985),t.e(98683),t.e(72003),t.e(48094),t.e(49267),t.e(54285),t.e(26570)]).then(t.bind(t,26570))).default,LineOfSightLayer:async()=>(await t.e(62635).then(t.bind(t,62635))).default,LinkChartLayer:async()=>(await Promise.all([t.e(99985),t.e(98683),t.e(72003),t.e(48094),t.e(49267),t.e(54285),t.e(17079)]).then(t.bind(t,17079))).default,MapImageLayer:async()=>(await Promise.all([t.e(89122),t.e(17872),t.e(55721),t.e(82951)]).then(t.bind(t,82951))).default,MapNotesLayer:async()=>(await t.e(43311).then(t.bind(t,43311))).default,MediaLayer:async()=>(await Promise.all([t.e(9639),t.e(95355)]).then(t.bind(t,46061))).default,OGCFeatureLayer:async()=>(await Promise.all([t.e(26799),t.e(25526)]).then(t.bind(t,1741))).default,OpenStreetMapLayer:async()=>(await t.e(50803).then(t.bind(t,50803))).default,OrientedImageryLayer:async()=>(await t.e(3832).then(t.bind(t,3832))).default,PointCloudLayer:async()=>(await t.e(11830).then(t.bind(t,11830))).default,RouteLayer:async()=>(await Promise.all([t.e(21297),t.e(5534)]).then(t.bind(t,5534))).default,SceneLayer:async()=>(await Promise.all([t.e(74279),t.e(16105)]).then(t.bind(t,16105))).default,StreamLayer:async()=>(await t.e(84369).then(t.bind(t,84369))).default,SubtypeGroupLayer:async()=>(await t.e(86061).then(t.bind(t,86061))).default,TileLayer:async()=>(await Promise.all([t.e(89122),t.e(17872),t.e(55721),t.e(71174)]).then(t.bind(t,71174))).default,UnknownLayer:async()=>(await t.e(8896).then(t.bind(t,8896))).default,UnsupportedLayer:async()=>(await t.e(72043).then(t.bind(t,72043))).default,VectorTileLayer:async()=>(await Promise.resolve().then(t.bind(t,53451))).default,VideoLayer:async()=>(await t.e(96277).then(t.bind(t,96277))).default,ViewshedLayer:async()=>(await t.e(29529).then(t.bind(t,29529))).default,VoxelLayer:async()=>(await t.e(88560).then(t.bind(t,88560))).default,WCSLayer:async()=>(await Promise.all([t.e(59844),t.e(93092),t.e(76964),t.e(18307),t.e(81633),t.e(92826),t.e(47933),t.e(29954)]).then(t.bind(t,29954))).default,WFSLayer:async()=>(await Promise.all([t.e(11316),t.e(26964)]).then(t.bind(t,26964))).default,WMSLayer:async()=>(await t.e(52015).then(t.bind(t,52015))).default,WMTSLayer:async()=>(await t.e(1845).then(t.bind(t,1845))).default,WebTileLayer:async()=>(await t.e(24552).then(t.bind(t,24552))).default}},67061:(e,a,t)=>{t.d(a,{V:()=>r});var n=t(3825);async function r(e,a){const{data:t}=await(0,n.A)(e,{responseType:"json",query:{f:"json",...a?.customParameters,token:a?.apiKey}});return t}}}]);
//# sourceMappingURL=6070.90c888e0.chunk.js.map