{"version":3,"file":"static/js/82951.98d67e06.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/MapImageLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import r from\"../request.js\";import t from\"../core/Error.js\";import{loadAll as s}from\"../core/loadAll.js\";import{MultiOriginJSONMixin as i}from\"../core/MultiOriginJSONSupport.js\";import{debounce as o,throwIfAbortError as a,isAbortError as n}from\"../core/promiseUtils.js\";import{property as p}from\"../core/accessorSupport/decorators/property.js\";import{Integer as m}from\"../core/accessorSupport/ensureType.js\";import\"../core/has.js\";import\"../core/RandomLCG.js\";import{reader as l}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as c}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as u}from\"../core/accessorSupport/decorators/writer.js\";import{nameToId as y,OriginId as h}from\"../core/accessorSupport/PropertyOrigin.js\";import d from\"../geometry/Extent.js\";import{getScale as f}from\"../geometry/support/scaleUtils.js\";import{srToRESTValue as g}from\"../geometry/support/spatialReferenceUtils.js\";import v from\"./Layer.js\";import{APIKeyMixin as b}from\"./mixins/APIKeyMixin.js\";import{ArcGISMapService as S}from\"./mixins/ArcGISMapService.js\";import{ArcGISService as j}from\"./mixins/ArcGISService.js\";import{BlendLayer as x}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as I}from\"./mixins/CustomParametersMixin.js\";import{OperationalLayer as w}from\"./mixins/OperationalLayer.js\";import{PortalLayer as O}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as E}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as L}from\"./mixins/ScaleRangeLayer.js\";import{SublayersOwner as P}from\"./mixins/SublayersOwner.js\";import{TemporalLayer as T}from\"./mixins/TemporalLayer.js\";import{url as A}from\"./support/commonProperties.js\";import{ExportImageParameters as M}from\"./support/ExportImageParameters.js\";import{createBitmap as R}from\"./support/imageBitmapUtils.js\";import U from\"./support/Sublayer.js\";import{shouldWriteSublayerStructure as _}from\"./support/sublayerUtils.js\";import{serviceSupportsSpatialReference as F}from\"./support/versionUtils.js\";import N from\"../symbols/support/ElevationInfo.js\";import{T as J}from\"../chunks/TimeExtent.js\";import{timeZoneProperty as V}from\"../time/timeZoneUtils.js\";import{SaveOperationType as q}from\"../webdoc/interfaces.js\";let k=class extends(x(T(L(P(S(j(w(O(i(E(b(I(v))))))))))))){constructor(...e){super(...e),this._exportImageParameters=new M({layer:this}),this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.dpi=96,this.elevationInfo=new N({mode:\"on-the-ground\"}),this.gdbVersion=null,this.imageFormat=\"png24\",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType=\"ArcGISMapServiceLayer\",this.preferredTimeZone=null,this.sourceJSON=null,this.sublayers=null,this.type=\"map-image\",this.url=null,this._debouncedSaveOperations=o((async(e,r,t)=>{const{save:s,saveAs:i}=await import(\"./save/mapImageLayerUtils.js\");switch(e){case q.SAVE:return s(this,r);case q.SAVE_AS:return i(this,t,r)}}))}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const r=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).catch(a).then((()=>this._fetchService(r)))),Promise.resolve(this)}destroy(){this._exportImageParameters.destroy()}readImageFormat(e,r){const t=r.supportedImageFormatTypes;return t&&t.includes(\"PNG32\")?\"png32\":\"png24\"}writeSublayers(e,r,t,s){if(!this.loaded||!e)return;const i=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray();let o=!1;const a=y(s.origin);let n;if(this.capabilities?.operations.supportsExportMap&&this.capabilities?.exportMap?.supportsDynamicLayers)if(a===h.PORTAL_ITEM){const e=this.createSublayersForOrigin(\"service\").sublayers;o=_(i,e,h.SERVICE)}else if(a>h.PORTAL_ITEM){const e=this.createSublayersForOrigin(\"portal-item\");o=_(i,e.sublayers,y(e.origin)),n=e.originWithPartialOverrides}const p=[],m={writeSublayerStructure:o,...s,minimumWritableOrigin:n};let l=o||this.hasVisibleLayersForOrigin(a);i.forEach((e=>{const r=e.write({},m);p.push(r),l=l||\"user\"===e.originOf(\"visible\")}));p.some((e=>Object.keys(e).length>1))&&(r.layers=p),l&&(r.visibleLayers=i.filter((e=>e.visible)).map((e=>e.id)))}createExportImageParameters(e,r,t,s){const i=s?.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian()),this._exportImageParameters.floors=s?.floors??null,this._exportImageParameters.scale=f({extent:e,width:r})*i;const o=this._exportImageParameters.toJSON(),a=!s?.rotation||this.version<10.3?{}:{rotation:-s.rotation},n=e?.spatialReference,p=g(n);o.dpi*=i;const m={};if(s?.timeExtent){const{start:e,end:r}=s.timeExtent.toJSON();m.time=e&&r&&e===r?\"\"+e:`${e??\"null\"},${r??\"null\"}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(m.time=\"null,null\");return{bbox:e?e.xmin+\",\"+e.ymin+\",\"+e.xmax+\",\"+e.ymax:void 0,bboxSR:p,imageSR:p,size:r+\",\"+t,...o,...a,...m}}async fetchImage(e,r,t,s){const{data:i}=await this._fetchImage(\"image\",e,r,t,s);return i}async fetchImageBitmap(e,r,t,s){const{data:i,url:o}=await this._fetchImage(\"blob\",e,r,t,s);return R(i,o,s?.signal)}async fetchRecomputedExtents(e={}){const t={...e,query:{returnUpdates:!0,f:\"json\",...this.customParameters,token:this.apiKey}},{data:s}=await r(this.url,t),{extent:i,fullExtent:o,timeExtent:a}=s,n=i||o;return{fullExtent:n&&d.fromJSON(n),timeExtent:a&&J.fromJSON({start:a[0],end:a[1]})}}loadAll(){return s(this,(e=>{e(this.allSublayers),e(this.subtables)}))}async save(e){return this._debouncedSaveOperations(q.SAVE,e)}async saveAs(e,r){return this._debouncedSaveOperations(q.SAVE_AS,r,e)}serviceSupportsSpatialReference(e){return F(this,e)}async _fetchImage(e,s,i,o,a){const p={responseType:e,signal:a?.signal??null,query:{...this.parsedUrl.query,...this.createExportImageParameters(s,i,o,a),f:\"image\",...this.refreshParameters,...this.customParameters,token:this.apiKey}},m=this.parsedUrl.path+\"/export\";if(null!=p.query?.dynamicLayers&&!this.capabilities?.exportMap?.supportsDynamicLayers)throw new t(\"mapimagelayer:dynamiclayer-not-supported\",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:p.query});try{const{data:e}=await r(m,p);return{data:e,url:m}}catch(l){if(n(l))throw l;throw new t(\"mapimagelayer:image-fetch-error\",`Unable to load image: ${m}`,{error:l})}}async _fetchService(e){if(this.sourceJSON)return void this.read(this.sourceJSON,{origin:\"service\",url:this.parsedUrl});const{data:t,ssl:s}=await r(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},signal:e});s&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=t,this.read(t,{origin:\"service\",url:this.parsedUrl})}hasVisibleLayersForOrigin(e){return!(null==e||!this.sublayersSourceJSON[e]?.visibleLayers)}};e([p(V(\"dateFieldsTimeReference\"))],k.prototype,\"dateFieldsTimeZone\",void 0),e([p({type:Boolean})],k.prototype,\"datesInUnknownTimezone\",void 0),e([p()],k.prototype,\"dpi\",void 0),e([p()],k.prototype,\"elevationInfo\",void 0),e([p()],k.prototype,\"gdbVersion\",void 0),e([p()],k.prototype,\"imageFormat\",void 0),e([l(\"imageFormat\",[\"supportedImageFormatTypes\"])],k.prototype,\"readImageFormat\",null),e([p({json:{origins:{service:{read:{source:\"maxImageHeight\"}}}}})],k.prototype,\"imageMaxHeight\",void 0),e([p({json:{origins:{service:{read:{source:\"maxImageWidth\"}}}}})],k.prototype,\"imageMaxWidth\",void 0),e([p()],k.prototype,\"imageTransparency\",void 0),e([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],k.prototype,\"isReference\",void 0),e([p({json:{read:!1,write:!1}})],k.prototype,\"labelsVisible\",void 0),e([p({type:[\"ArcGISMapServiceLayer\"]})],k.prototype,\"operationalLayerType\",void 0),e([p({json:{read:!1,write:!1}})],k.prototype,\"popupEnabled\",void 0),e([p(V(\"preferredTimeReference\"))],k.prototype,\"preferredTimeZone\",void 0),e([p()],k.prototype,\"sourceJSON\",void 0),e([p({json:{write:{ignoreOrigin:!0}}})],k.prototype,\"sublayers\",void 0),e([u(\"sublayers\",{layers:{type:[U]},visibleLayers:{type:[m]}})],k.prototype,\"writeSublayers\",null),e([p({type:[\"show\",\"hide\",\"hide-children\"],json:{origins:{\"portal-item\":{read:!1,write:!1}}}})],k.prototype,\"listMode\",void 0),e([p({json:{read:!1},readOnly:!0,value:\"map-image\"})],k.prototype,\"type\",void 0),e([p(A)],k.prototype,\"url\",void 0),k=e([c(\"esri.layers.MapImageLayer\")],k);const G=k;export{G as default};\n"],"names":["k","x","T","L","P","S","j","w","O","i","E","b","I","v","constructor","super","arguments","this","_exportImageParameters","M","layer","dateFieldsTimeZone","datesInUnknownTimezone","dpi","elevationInfo","N","mode","gdbVersion","imageFormat","imageMaxHeight","imageMaxWidth","imageTransparency","isReference","labelsVisible","operationalLayerType","preferredTimeZone","sourceJSON","sublayers","type","url","_debouncedSaveOperations","o","async","e","r","t","save","s","saveAs","q","SAVE","SAVE_AS","normalizeCtorArgs","load","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","a","then","_fetchService","Promise","resolve","destroy","readImageFormat","supportedImageFormatTypes","includes","writeSublayers","loaded","slice","reverse","flatten","_ref","toArray","y","origin","n","capabilities","operations","supportsExportMap","exportMap","supportsDynamicLayers","h","PORTAL_ITEM","createSublayersForOrigin","_","SERVICE","originWithPartialOverrides","p","m","writeSublayerStructure","minimumWritableOrigin","l","hasVisibleLayersForOrigin","forEach","write","push","originOf","some","Object","keys","length","layers","visibleLayers","filter","visible","map","id","createExportImageParameters","pixelRatio","version","clone","shiftCentralMeridian","floors","scale","f","extent","width","toJSON","rotation","spatialReference","g","timeExtent","start","end","time","timeInfo","hasLiveData","bbox","xmin","ymin","xmax","ymax","bboxSR","imageSR","size","fetchImage","data","_fetchImage","fetchImageBitmap","R","fetchRecomputedExtents","undefined","query","returnUpdates","customParameters","token","apiKey","fullExtent","d","fromJSON","J","loadAll","allSublayers","subtables","serviceSupportsSpatialReference","F","responseType","parsedUrl","refreshParameters","path","dynamicLayers","error","read","ssl","replace","sublayersSourceJSON","V","prototype","Boolean","json","origins","service","source","enabled","overridePolicy","ignoreOrigin","u","U","readOnly","value","A","c","G"],"sourceRoot":""}