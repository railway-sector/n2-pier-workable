{"version":3,"file":"static/js/89613.8d356ca4.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/layers/support/highlightUtils.js","../node_modules/@arcgis/core/views/3d/layers/support/ImageHighlightHelper3D.js","../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImagerySubView3D.js","../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../core/arrayUtils.js\";import o from\"../../../core/Collection.js\";import{isGraphic as t}from\"../../../support/guards.js\";function i(i){if(!i)return[];let e=t(i)?[i]:o.isCollection(i)?i.toArray():Array.isArray(i)?i:[];return e=e?.filter(r),0===(e?.length??0)?[]:e}export{i as getHighlightGraphics};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../Color.js\";import i from\"../../../../core/Accessor.js\";import{isSome as s}from\"../../../../core/arrayUtils.js\";import{makeHandle as r,destroyHandle as o}from\"../../../../core/handleUtils.js\";import{watch as h,syncAndInitial as p}from\"../../../../core/reactiveUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{initializeProjection as c,project as n}from\"../../../../geometry/projectionUtils.js\";import{GraphicsCollection as g}from\"../../../../support/GraphicsCollection.js\";import m from\"../../../../symbols/SimpleFillSymbol.js\";import u from\"../../../../symbols/SimpleLineSymbol.js\";import d from\"../../../../symbols/SimpleMarkerSymbol.js\";import{getHighlightGraphics as y}from\"../../../layers/support/highlightUtils.js\";let w=class extends i{get updating(){return this.graphicsView?.updating??!1}constructor(t){super(t),this._highlightCounts=new Map,this._graphicsViewLoader=null,this.graphics=new g,this.graphicsView=null,this.suspended=!1;const i=new e([255,255,255,1/255]);this._symbols=new Map([[\"point\",new d({size:\"2px\",style:\"square\",color:i})],[\"polyline\",new u({width:\"2px\",color:i})],[\"polygon\",new m({outline:null,color:i})]])}highlight(t,e){const i=y(t);if(0===i.length)return r();let s,o=!1;return this.updatingHandles.addPromise(Promise.all([this._createHighlightGraphics(i),this._ensureGraphicsView3D()]).then((([t,i])=>{!o&&i&&(s=this._addHighlightGraphics(i,t,e))}))),r((()=>{o=!0,s?.remove()}))}preload(){this._ensureGraphicsView3D()}_addHighlightGraphics(t,e,i){for(const r of e)this._highlightCounts.set(r,(this._highlightCounts.get(r)??0)+1);this.graphics.addMany(e);const s=t.highlight(e,i);return r((()=>{this._removeHighlightGraphics(e),s.remove()}))}_removeHighlightGraphics(t){this.graphics.removeMany(t.filter((t=>{const e=Math.max(0,(this._highlightCounts.get(t)??0)-1);return 0===e?(this._highlightCounts.delete(t),!0):(this._highlightCounts.set(t,e),!1)})))}async _ensureGraphicsView3D(){if(this.graphicsView)return this.graphicsView;this._graphicsViewLoader||(this._graphicsViewLoader=import(\"../GraphicsView3D.js\"));const{default:t}=await this._graphicsViewLoader;if(this.destroyed)return null;const e=new t({view:this.view,layer:this.layer,getGraphics:()=>this.graphics,drapeSourcePriorityOffset:.5});return this._set(\"graphicsView\",e),this.addHandles([o(this.graphicsView),h((()=>this.suspended),(t=>{e.suspended=t}),p)]),e}async _createHighlightGraphics(t){const e=t.map((({geometry:t})=>t?.spatialReference)).filter(s).reduce(((t,e)=>(0!==t.length&&t.at(-1)?.equals(e)||t.push(e),t)),[]),i=this.view.spatialReference,r=e.map((t=>({source:t,dest:i})));try{await c(r)}catch{return[]}return t.map((t=>{const{geometry:e}=t;try{const s=e?n(e,i):null,r=t.cloneShallow();return r.geometry=s,r.symbol=this._symbols.get(s?.type),r}catch{return t}}))}};t([a()],w.prototype,\"graphics\",void 0),t([a()],w.prototype,\"graphicsView\",void 0),t([a()],w.prototype,\"view\",void 0),t([a()],w.prototype,\"layer\",void 0),t([a()],w.prototype,\"updatingHandles\",void 0),t([a()],w.prototype,\"suspended\",void 0),t([a()],w.prototype,\"updating\",null),w=t([l(\"esri.views.3d.layers.support.ImageHighlightHelper3D\")],w);export{w as ImageHighlightHelper3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Error.js\";import{throwIfAborted as r}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import i from\"../../geometry/Point.js\";import{combineTimeExtent as a}from\"../../layers/support/timeSupport.js\";import{load as p,getSourceScale as n}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import u from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as c}from\"./support/popupUtils.js\";const m=m=>{let l=class extends m{constructor(){super(...arguments),this.view=null}get timeExtent(){return a(this.layer,this.view?.timeExtent,this._get(\"timeExtent\"))}async fetchPopupFeaturesAtLocation(e,o){const{layer:s}=this;if(!e)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:a}=s,p=c(s,o);if(!a||null==p)return[];const n=await p.getRequiredFields();r(o);const m=new u;m.timeExtent=this.timeExtent,m.geometry=e,m.outFields=n,m.outSpatialReference=e.spatialReference;const{resolution:l,spatialReference:y}=this.view,h=\"2d\"===this.view.type?new i(l,l,y):new i(.5*l,.5*l,y),{returnTopmostRaster:f,showNoDataRecords:w}=p.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},d={returnDomainValues:!0,returnTopmostRaster:f,pixelSize:h,showNoDataRecords:w,signal:o?.signal};return s.queryVisibleRasters(m,d).then((e=>e))}async getSourceScale(){return await p(),await this.layer.load(),n(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([o()],l.prototype,\"layer\",void 0),e([o()],l.prototype,\"suspended\",void 0),e([o({readOnly:!0})],l.prototype,\"timeExtent\",null),e([o()],l.prototype,\"view\",void 0),l=e([s(\"esri.views.layers.ImageryLayerView\")],l),l};export{m as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as i}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as t}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DrapedSubView3D.js\";let s=class extends r{constructor(e){super(e),this.redrawDebounced=a((async e=>{this.redraw(((e,a)=>this._redrawImage(e,a)),e)}),2e3)}initialize(){this.addHandles([i((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this.updatingHandles.addPromise(this.redrawDebounced())))])}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}async processResult(e,a,i){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,i))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const i=e.image,t=i.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;i.width=s.width,i.height=s.height;const o=t.createImageData(s.width,s.height);o.data.set(s.getAsRGBA()),t.putImageData(o,0,0)}};s=e([t(\"esri.views.3d.layers.ImagerySubView3D\")],s);export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{destroyHandle as t}from\"../../../core/handleUtils.js\";import has from\"../../../core/has.js\";import{watch as i,syncAndInitial as r,initial as s}from\"../../../core/reactiveUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import h from\"./DynamicLayerView3D.js\";import l from\"./FlowSubView3D.js\";import p from\"./ImagerySubView3D.js\";import{ImageHighlightHelper3D as n}from\"./support/ImageHighlightHelper3D.js\";import d from\"../../layers/ImageryLayerView.js\";let g=class extends(d(h)){constructor(){super(...arguments),this.type=\"imagery-3d\"}get highlightOptions(){return null}get pixelData(){return null}initialize(){const e=()=>this._updatingHandles.addPromise(this.refreshDebounced());this._updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),e),this._updatingHandles.add((()=>this.layer?.renderer),e),this._updatingHandles.add((()=>this.timeExtent),e),this._highlightHelper=new n({view:this.view,layer:this.layer,updatingHandles:this._updatingHandles}),this.addHandles([t(this._highlightHelper),i((()=>this.suspended),(e=>this._highlightHelper.suspended=e),r)])}_initSubView(){this.addHandles([i((()=>this.layer.renderer),(e=>this._recreateSubView(e)),s)])}_recreateSubView(e){const t=\"flow\"===e?.type,i=\"flow\"===this.subView?.type,r=this.subView;r&&t===i||(this.subView=t&&has(\"enable-feature:3d-flow\")?new l({layerView:this}):new p({layerView:this}),r?.destroy())}getFetchOptions(){return{timeExtent:this.timeExtent}}highlight(e,t){return this._highlightHelper.highlight(e,t)}isUpdating(){return super.isUpdating()||this._highlightHelper.updating}};e([a()],g.prototype,\"highlightOptions\",null),e([a()],g.prototype,\"pixelData\",null),g=e([o(\"esri.views.3d.layers.ImageryLayerView3D\")],g);const m=g;export{m as default};\n"],"names":["i","e","t","o","isCollection","toArray","Array","isArray","filter","r","length","w","updating","this","graphicsView","constructor","super","_highlightCounts","Map","_graphicsViewLoader","graphics","g","suspended","_symbols","d","size","style","color","u","width","m","outline","highlight","y","s","updatingHandles","addPromise","Promise","all","_createHighlightGraphics","_ensureGraphicsView3D","then","_ref","_addHighlightGraphics","remove","preload","set","get","addMany","_removeHighlightGraphics","removeMany","Math","max","delete","default","destroyed","view","layer","getGraphics","drapeSourcePriorityOffset","_set","addHandles","h","p","map","_ref2","geometry","spatialReference","reduce","at","equals","push","source","dest","c","n","cloneShallow","symbol","type","a","prototype","l","arguments","timeExtent","_get","fetchPopupFeaturesAtLocation","popupEnabled","getRequiredFields","outFields","outSpatialReference","resolution","returnTopmostRaster","f","showNoDataRecords","layerOptions","returnDomainValues","pixelSize","signal","queryVisibleRasters","getSourceScale","load","serviceRasterInfo","canResume","isEmpty","readOnly","redrawDebounced","async","redraw","_redrawImage","initialize","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","on","maximumDataResolution","loaded","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","applyFilter","pixelBlock","height","createImageData","data","getAsRGBA","putImageData","highlightOptions","_updatingHandles","refreshDebounced","add","exportImageServiceParameters","version","renderer","_highlightHelper","_initSubView","_recreateSubView","subView","has","layerView","destroy","getFetchOptions","isUpdating"],"sourceRoot":""}